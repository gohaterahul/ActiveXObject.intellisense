<job>
<script src="..\src\ActiveXObject.js" />
<script src="..\src\WScript.Shell.js" />
<script>

var shell    = new ActiveXObject('WScript.Shell')
  , env      = shell.Environment('SYSTEM')
  , allusers = shell.SpecialFolders('AllUsersDesktop')
  , desktop  = shell.SpecialFolders('Desktop')
  , link     = shell.CreateShortcut(desktop + '/test.lnk')
  , url      = shell.CreateShortcut(desktop + '/test.url')
  , text     = []
//, exec     = shell.Exec('notepad.exe')
//exec.StdOut.ReadAll()

text.push(
  allusers
, 'OS = ' + env('OS')
, '# of CPU = ' + env('NUMBER_OF_PROCESSORS')
)

shell.Popup(
  text.join('\n')
, 0
, 'Title'
, 1 + 16
)

function RegistryTest() {
  shell.RegWrite('HKCU\\Software\\ACME\\FortuneTeller\\', 1, 'REG_BINARY')
  shell.RegWrite('HKCU\\Software\\ACME\\FortuneTeller\\MindReader', 'Goocher!', 'REG_SZ')

  var values = [
      shell.RegRead('HKCU\\Software\\ACME\\FortuneTeller\\')
    , shell.RegRead('HKCU\\Software\\ACME\\FortuneTeller\\MindReader')
  ]

  shell.RegDelete('HKCU\\Software\\ACME\\FortuneTeller\\MindReader')
  shell.RegDelete('HKCU\\Software\\ACME\\FortuneTeller\\')
  shell.RegDelete('HKCU\\Software\\ACME\\')
  return values
}

function SendKeysTest() {
  shell.Run('calc')                ; sleep(100)
  shell.AppActivate('Calculator')  ; sleep(100)
  shell.SendKeys('1{+}')           ; sleep(500)
  shell.SendKeys('2')              ; sleep(500)
  shell.SendKeys('~')              ; sleep(500)
  shell.SendKeys('*3')             ; sleep(500)
  shell.SendKeys('~')              ; sleep(2500)
  function sleep(n) {
   WScript.Sleep(n)
  }
}

</script>
</job>